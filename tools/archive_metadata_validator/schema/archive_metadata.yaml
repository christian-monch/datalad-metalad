$schema": "http://json-schema.org/draft-07/schema#"
"$id": "http://psychoinformatics.inm7.de/schemas/archived_study.json"

definitions:
  person-data:
    type: object
    required:
      - person
    properties:
      person:
        type: object
        required:
          - email
          - first_name
          - last_name
        properties:
          email:
            description: Institutional email, must be globally unique
            type: string
          first_name:
            type: string
          last_name:
            type: string
          title:
            type: string
          affiliation:
            type: string
          role:
            $ref: "#definitions/role"
          additional_contact_information:
            type: string
          orcid-id:
            type: string

  role:
    type: string

  named-person-ref:
    type: object
    required:
      - first_name
      - last_name
    properties:
      first_name:
        type: string
      last_name:
        type: string

  email-person-ref:
    type: string

  person-ref:
    oneOf:
      - $ref: "#definitions/named-person-ref"
      - $ref: "#definitions/email-person-ref"

  author-list:
    type: array
    items:
      $ref: "#definitions/person-ref"

  contributor-data:
    type: object
    required:
      - person
      - roles
    properties:
      person:
        $ref: "#definitions/person-ref"
      roles:
        type: array
        items:
          $ref: "#definitions/role"

  contributor-list:
    type: array
    items:
      $ref: "#definitions/contributor-data"

  date:
    type: string
    format: date

  publication:
    type: object
    properties:
      publication:
        type: object
        required:
          - title
          - corresponding_author
          - date
        properties:
          title:
            type: string
          corresponding_author:
            $ref: "#definitions/person-ref"
          authors:
            $ref: "#definitions/author-list"
          date:
            $ref: "#definitions/date"
          doi:
            type: string
          publication:
            type: string
          volume:
            type: string
          issue:
            type: string
          pages:
            type: string
          publisher:
            type: string

  keywords:
    type: array
    items:
      type: string

  person-list:
    type: array
    items:
      $ref: "#definitions/person-data"

  publications:
    type: array
    items:
      $ref: "#definitions/publication"

  dataset:
    description: The data that should be archived
    type: object
    required:
      - name
      - url
    properties:
      name:
        type: string
      url:
        description: URL of the entry point for the data
        type: string
      description:
        description: Human-readable description of the data and what it describes
        type: string
      data_format:
        type: string
      keywords:
        $ref: "#definitions/keywords"
      contributors:
        $ref: "#definitions/contributor-list"

type: object
required:
  - study
properties:
  study:
    type: object
    required:
      - name
      - dataset
    properties:
      name:
        type: string
      purpose:
        description: Why was the study performed
        type: string
      start_date:
        $ref: "#definitions/date"
      end_date:
        $ref: "#definitions/date"
      keywords:
        $ref: "#definitions/keywords"
      persons:
        $ref: "#definitions/person-list"
      contributors:
        $ref: "#definitions/contributor-list"
      publications:
        $ref: "#definitions/publications"
      dataset:
        $ref: "#definitions/dataset"
